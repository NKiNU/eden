$(document).ready(function(){var x=$("#inv_track_item_item_id");if(x.length){var I,E=S3.supply.packs||{},u,a,m=S3.supply.binnedQuantity||0,B,O=$("#rdy-defaultbin-0"),g,F,y=$("#sub-defaultrecv_bin"),n=x.val(),z=$("#inv_track_item_item_pack_id"),C,h,A=$("#sub_defaultrecv_bin_defaultrecv_bin_i_quantity_edit_none"),P=/(\d)(?=(\d{3})+(?!\d))/g,p=$("#sub_defaultrecv_bin_defaultrecv_bin_i_quantity_edit_0"),q,J,r,D,G,K,d,e=$("#inv_track_item_quantity"),k=$("#inv_track_item_recv_quantity"),b,Q=S3.supply.req_data||
{},t,v=$("#inv_track_item_req_item_id"),H=$("#inv_track_item_req_item_id__row"),c,L;H.length&&H.hide();var M=function(){F=!0;D=E[n];G={};K=D.length;z.html("");for(i=0;i<K;i++)r=D[i],G[r.i]=r.q,F?(C=r.i,q=d=r.q,selected=" selected"):selected="",F=!1,J='<option value="'+r.i+'"'+selected+">"+r.n+"</option>",z.append(J)};x.on("change.s3",function(w,l){n=x.val();(D=E[n])?M():(I=S3.Ap.concat("/supply/item_packs.json/"+n),$.ajaxS3({url:I,dataType:"json",success:function(R){E[n]=R;M()}}));if(l)(c=e.val())&&
(c=parseFloat(c)),b=(b=k.val())?parseFloat(b):c;else{e.val("");k.val("");if(t=Q[n])if(1==t.length){var f=t[0];c=f.q/d;e.val(c);v.val(f.i)}else{H.show();var N;v.html("");l=!0;for(i=0;i<t.length;i++)f=t[i],v.append(new Option(f.r,f.u)),l&&(c=f.q/d,e.val(void 0)),l=!1;v.on("change",function(){N=parseInt(v.val());for(i=0;i<t.length;i++)if(f=t[i],f.i==N){c=f.q/d;e.val(c);break}})}else v.val(""),c=0;b=0;y.inlinecomponent("removeRows");m=0}});n&&(startingItemPackID=C=z.val(),x.trigger("change.s3",!0));z.on("change.s3",
function(){C=z.val();d=G[C];if(c=e.val())c=parseFloat(c),c=c*q/d,e.val(totalQuantity),(b=k.val())?(b=parseFloat(b),b=b*q/d,k.val(b)):b=c;a=A.val();a=a*q/d;A.val(a);a=p.val();a=a*q/d;p.val(a);L=function(w){a=w.quantity.value;a=a*q/d;w.quantity.value=a;w.quantity.text=a.toString().replace(P,"$1,")};y.inlinecomponent("updateRows",L);q=d});y.on("click.s3",".inline-edt",function(){if(a=p.val())a=parseFloat(a),m-=a*d});O.click(function(){if(a=p.val())a=parseFloat(a),m+=a*d});e.change(function(){(c=e.val())?
(c=parseFloat(c),(b=k.val())?(b=parseFloat(b),b>c&&(h="Quantity Sent increased to Quantity Received",g=$('<div class="alert alert-warning" style="padding-left:36px;">'+h+'<button type="button" class="close" data-dismiss="alert">\u00d7</button></div>'),c=b,e.val(b).parent().append(g).undelegate(".s3").delegate(".alert","click.s3",function(){$(this).fadeOut("slow").remove();return!1}))):b=c):c=b=0});k.change(function(){(b=k.val())?(b=parseFloat(b),b>c&&(h="Quantity Received reduced to Quantity Sent",
g=$('<div class="alert alert-warning" style="padding-left:36px;">'+h+'<button type="button" class="close" data-dismiss="alert">\u00d7</button></div>'),b=c,k.val(c).parent().append(g).undelegate(".s3").delegate(".alert","click.s3",function(){$(this).fadeOut("slow").remove();return!1}))):b=c});A.change(function(){if(a=A.val())a=parseFloat(a),B=1*m/d,u=b-B,a>u&&(h="Bin Quantity reduced to Quantity remaining to be Received",g=$('<div class="alert alert-warning" style="padding-left:36px;">'+h+'<button type="button" class="close" data-dismiss="alert">\u00d7</button></div>'),
A.val(u).parent().append(g).undelegate(".s3").delegate(".alert","click.s3",function(){$(this).fadeOut("slow").remove();return!1}))});p.change(function(){if(a=p.val())a=parseFloat(a),B=1*m/d,u=b-B,a>u&&(h="Bin Quantity reduced to Quantity remaining to be Received",g=$('<div id="sub_defaultrecv_bin_defaultrecv_bin_i_quantity_edit_0-warning" class="alert alert-warning" style="padding-left:36px;">'+h+'<button type="button" class="close" data-dismiss="alert">\u00d7</button></div>'),p.val(u).parent().append(g).undelegate(".s3").delegate(".alert",
"click.s3",function(){$(this).fadeOut("slow").remove();return!1}))});y.on("rowAdded",function(w,l){if(a=l.quantity.value)a=parseFloat(a),m+=a*d});y.on("rowRemoved",function(w,l){if(a=l.quantity.value)a=parseFloat(a),m-=a*d})}});
